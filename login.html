<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - PathshalaOne</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/2.4.2/uicons-regular-rounded/css/uicons-regular-rounded.css'>
    <link rel="stylesheet" href="style.css">
    <script>
        // Theme script
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    </script>
    <script>
        if (history.scrollRestoration) {
            history.scrollRestoration = 'manual';
        }
    </script>
    <script>
        // Tailwind Config
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], },
                    colors: {
                        'light-bg': '#fffcef',
                        'dark-bg': '#100c08',
                        'light-card': '#fbf9f0',
                        'dark-card': '#201c18',
                        'dark-interactive': '#302c28',
                        orange: {
                            '50': '#fff7ed', '100': '#ffedd5', '200': '#fed7aa', '300': '#fdba74',
                            '400': '#fb923c', '500': '#f97316', '600': '#ea580c', '700': '#c2410c',
                            '800': '#9a3412', '900': '#7c2d12', '950': '#431407',
                        },
                    },
                }
            }
        }
    </script>
    <style>
        /* Custom animations for the role selection transition */
        @keyframes slide-up-out {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(-100%); opacity: 0; }
        }
        @keyframes slide-down-out {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(100%); opacity: 0; }
        }
        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fade-out-down {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(20px); }
        }

        /* Animation utility classes */
        .animate-slide-up-out {
            animation: slide-up-out 0.4s ease-in forwards;
        }
        .animate-slide-down-out {
            animation: slide-down-out 0.4s ease-in forwards;
        }
        .animate-fade-in-up {
            animation: fade-in-up 0.5s ease-out forwards;
        }
        .animate-fade-out-down {
            animation: fade-out-down 0.3s ease-in forwards;
        }
    </style>
</head>
<body class="bg-light-bg dark:bg-dark-bg text-slate-700 dark:text-slate-300">

    <a href="index.html" class="absolute top-6 left-6 z-10 flex items-center gap-2 text-slate-600 dark:text-slate-300 hover:text-orange-600 dark:hover:text-orange-500 transition-colors font-semibold">
        <i class="fi fi-rr-arrow-left"></i>
        <span>Back to Home</span>
    </a>

    <button id="theme-toggle" class="absolute top-6 right-6 z-10 p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-dark-card focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 dark:focus:ring-offset-dark-bg">
        <i id="theme-icon-light" class="fi fi-rr-sun text-xl hidden"></i>
        <i id="theme-icon-dark" class="fi fi-rr-moon text-xl hidden"></i>
    </button>

    <div class="min-h-screen flex flex-col items-center justify-center p-6">
        <div class="text-center mb-8">
            <a href="index.html" class="flex items-center justify-center space-x-3 cursor-pointer">
                <i class="fi fi-rr-graduation-cap text-4xl sm:text-5xl text-orange-600"></i>
                <h1 class="text-3xl sm:text-4xl font-bold text-slate-800 dark:text-white">Pathshala<span class="text-orange-600">One</span></h1>
            </a>
        </div>
        
        <!-- Main Login Card: Added id="login-card", overflow-hidden and transition for min-height -->
        <div id="login-card" class="w-full max-w-md bg-white dark:bg-dark-card rounded-2xl shadow-xl p-8 md:p-10 transition-[min-height] duration-500 ease-in-out overflow-hidden">
            <!-- Step 1: Role Selection -->
            <div id="role-selection">
                <h2 class="text-2xl md:text-3xl font-bold text-center text-slate-900 dark:text-white mb-8">Select Your Role</h2>
                <div class="space-y-4">
                    <button id="admin-role-btn" class="w-full flex items-center text-left gap-4 p-5 bg-light-card dark:bg-dark-interactive rounded-xl hover:bg-orange-100 dark:hover:bg-orange-900/50 border-2 border-transparent hover:border-orange-400 transition-all duration-300">
                        <i class="fi fi-rr-user-gear text-3xl text-orange-600"></i>
                        <div>
                            <h3 class="font-bold text-lg text-slate-800 dark:text-white">Admin</h3>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Access the college management dashboard.</p>
                        </div>
                    </button>
                    <button id="super-admin-role-btn" class="w-full flex items-center text-left gap-4 p-5 bg-light-card dark:bg-dark-interactive rounded-xl hover:bg-orange-100 dark:hover:bg-orange-900/50 border-2 border-transparent hover:border-orange-400 transition-all duration-300">
                        <i class="fi fi-rr-user-crown text-3xl text-orange-600"></i>
                        <div>
                            <h3 class="font-bold text-lg text-slate-800 dark:text-white">Super Admin</h3>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Full control over the entire platform.</p>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Step 2: Login Form (hidden by default) -->
            <div id="login-form" class="hidden">
                 <button id="back-to-roles" class="flex items-center gap-2 mb-6 text-sm text-slate-500 dark:text-slate-400 hover:text-orange-600 font-semibold">
                    <i class="fi fi-rr-angle-small-left"></i>
                    <span>Change Role</span>
                </button>
                <h2 id="login-title" class="text-2xl md:text-3xl font-bold text-center text-slate-900 dark:text-white mb-8">Login</h2>
                <form action="#" class="space-y-6">
                    <input type="hidden" id="role" name="role">
                    <div>
                        <label for="username" class="block mb-2 text-sm font-medium text-slate-600 dark:text-slate-300">Username</label>
                        <input type="text" id="username" name="username" class="w-full px-4 py-3 bg-light-card dark:bg-dark-interactive border-2 border-slate-200 dark:border-gray-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition" placeholder="Enter your username" required>
                    </div>
                    <div>
                        <label for="password" class="block mb-2 text-sm font-medium text-slate-600 dark:text-slate-300">Password</label>
                        <input type="password" id="password" name="password" class="w-full px-4 py-3 bg-light-card dark:bg-dark-interactive border-2 border-slate-200 dark:border-gray-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition" placeholder="••••••••" required>
                    </div>
                    <button type="submit" class="w-full px-8 py-4 font-bold text-white bg-orange-600 rounded-xl hover:bg-orange-700 focus:outline-none focus:ring-4 focus:ring-orange-300 dark:focus:ring-orange-800 transition-transform hover:scale-105">
                        Login
                    </button>
                </form>
            </div>
        </div>
    </div>
    
    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Element selections
            const mainCard = document.getElementById('login-card');
            const roleSelectionDiv = document.getElementById('role-selection');
            const loginFormDiv = document.getElementById('login-form');
            const adminRoleBtn = document.getElementById('admin-role-btn');
            const superAdminRoleBtn = document.getElementById('super-admin-role-btn');
            const backToRolesBtn = document.getElementById('back-to-roles');
            const loginTitle = document.getElementById('login-title');
            const roleInput = document.getElementById('role');
            
            let originalCardHeight = 0;
            // Use a timeout to ensure all content is loaded before getting height
            setTimeout(() => {
                originalCardHeight = mainCard.offsetHeight;
                mainCard.style.minHeight = originalCardHeight + 'px';
            }, 100);

            // Function to handle switching to the login form view
            const showLoginForm = (role, title) => {
                roleInput.value = role;
                loginTitle.textContent = title;

                // 1. Add "split slice" animation classes to the role buttons
                adminRoleBtn.classList.add('animate-slide-up-out');
                superAdminRoleBtn.classList.add('animate-slide-down-out');

                // 2. Expand the card's height
                mainCard.style.minHeight = '490px';

                // 3. Wait for the exit animation to complete
                setTimeout(() => {
                    roleSelectionDiv.classList.add('hidden'); // Hide roles
                    loginFormDiv.classList.remove('hidden'); // Show form
                    loginFormDiv.classList.add('animate-fade-in-up'); // Animate form in

                    // 4. Clean up animation classes from role buttons for next time
                    adminRoleBtn.classList.remove('animate-slide-up-out');
                    superAdminRoleBtn.classList.remove('animate-slide-down-out');
                }, 400); // Duration matches the CSS exit animation
            };

            // Function to handle returning to the role selection view
            const showRoleSelection = () => {
                // 1. Animate the login form out
                loginFormDiv.classList.add('animate-fade-out-down');

                // 2. Shrink the card back to its original height
                mainCard.style.minHeight = originalCardHeight + 'px';

                // 3. Wait for animation
                setTimeout(() => {
                    loginFormDiv.classList.add('hidden'); // Hide form
                    roleSelectionDiv.classList.remove('hidden'); // Show roles
                    
                    // 4. Clean up form and its animation classes
                    loginFormDiv.classList.remove('animate-fade-in-up', 'animate-fade-out-down');
                    document.getElementById('username').value = '';
                    document.getElementById('password').value = '';
                }, 300); // Duration matches the CSS fade-out animation
            };
            
            // Event Listeners for role buttons and back button
            adminRoleBtn.addEventListener('click', () => showLoginForm('admin', 'Admin Login'));
            superAdminRoleBtn.addEventListener('click', () => showLoginForm('superadmin', 'Super Admin Login'));
            backToRolesBtn.addEventListener('click', showRoleSelection);

            // Note: Theme toggle logic is now handled by the global script.js
        });
    </script>
</body>
</html>
